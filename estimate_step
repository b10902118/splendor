
    // estimate best case: three and then two
    while (ncolor >= 2) {
        for (int i = 0, cnt = 0; i < Gem::normal && cnt < 3; ++i) {
            if (diff[i] > 0) {
                if (--diff[i] == 0) --ncolor;
                ++cnt;
            }
        }
        ++ret.n;
    }
    if (ncolor == 1) {
        for (int d : diff)
            if (d > 0) ret.n += (d & 1) ? d / 2 + 1 : d / 2;
    }
